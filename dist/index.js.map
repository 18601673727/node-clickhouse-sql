{"version":3,"sources":["../src/index.js"],"names":["EQUALS","EQ","GREATER","GT","GREATER_OR_EQUALS","GTE","LESS","LT","LESS_OR_EQUALS","LTE","NOT_EQUALS","NE","Consts","SQLObject","Conditions","args","arg","push","length","Disjunction","map","join","Conjunction","s","toString","Condition","column","operator","value","quoteTerm","quoteVal","Negation","InclusionOperator","inclusionType","Array","isArray","val","In","NotIn","GlobalNotIn","GlobalIn","Operators","createCondition","Error","commonReplacer","Value","replace","Term","term","Number","isFinite","SQLFunction","name","_curry_f","_cast","thing","t","AggregateFunctions","count","any","anyLast","min","max","sum","avg","uniq","uniqCombined","uniqHLL12","uniqExact","groupArray","groupUniqArray","ArithmeticFunctions","plus","minus","multiply","divide","intDiv","intDivOrZero","modulo","negate","abs","TimeFunctions","toYear","toMonth","toDayOfMonth","toDayOfWeek","toHour","toMinute","toTime","toDate","toDateTime","toDateTime64","toStartOfDay","toStartOfMonth","toStartOfQuarter","toStartOfYear","toStartOfMinute","toStartOfFiveMinute","toStartOfHour","now","today","yesterday","IPAddrFunctions","toIPv4","toIPv6","IPv4NumToString","IPv4StringToNum","IPv4NumToStringClassC","IPv6NumToString","IPv6StringToNum","Raw","string","raw","Query","Select","tables","conditions","having_conditions","preconditions","aggregations","select_list","order_expressions","request_totals","undefined","sampling","limits","limitbycolumns","columns","forEach","col","table","Object","keys","values","condition","aggregateExpressions","a","number","offset","limit","expressions","e","c","from","prewhere","where","groupby","having","order_by","with_totals","sample","limitby","Queries","Utility","cast","Dialect"],"mappings":"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","sourcesContent":["const EQUALS = \"=\";\nconst EQ = EQUALS;\nconst GREATER = \">\";\nconst GT = GREATER;\nconst GREATER_OR_EQUALS = \">=\";\nconst GTE = GREATER_OR_EQUALS;\nconst LESS = \"<\";\nconst LT = LESS;\nconst LESS_OR_EQUALS = \"<=\";\nconst LTE = LESS_OR_EQUALS;\nconst NOT_EQUALS = \"!=\";\nconst NE = NOT_EQUALS;\n\nconst Consts = {\n  EQUALS,\n  GREATER,\n  GREATER_OR_EQUALS,\n  LESS,\n  LESS_OR_EQUALS,\n  NOT_EQUALS,\n  EQ,\n  GT,\n  GTE,\n  LT,\n  LTE,\n  NE\n};\n\nclass SQLObject {\n}\n\nclass Conditions extends SQLObject {\n  constructor(...args) {\n    super();\n    this.args = args;\n  }\n\n  push(arg) {\n    this.args.push(arg);\n  }\n\n  get length() {\n    return this.args.length;\n  }\n}\n\nclass Disjunction extends Conditions {\n  constructor(...args) {\n    super(...args);\n  }\n\n  toString() {\n    return this.args.length ? this.args.map(arg => \"(\" + arg + \")\").join(\" or \") : \"\";\n  }\n}\n\nclass Conjunction extends Conditions {\n  constructor(...args) {\n    super(...args);\n  }\n\n  toString() {\n    if (!this.args.length) return \"\";\n\n    return this.args.map((arg) => {\n      const s = (arg.toString) ? arg.toString() : arg;\n      return \"(\" + s + \")\";\n    }).join(\" and \");\n  }\n}\n\nclass Condition extends SQLObject {\n  constructor(column, operator, value) {\n    super();\n    this.column = column;\n    this.operator = operator;\n    this.value = value;\n  }\n\n  toString() {\n    if (this.operator) {\n      return [quoteTerm(this.column), this.operator, quoteVal(this.value)].join(' ');\n    } else {\n      return this.column;\n    }\n  }\n}\n\nclass Negation extends Condition {\n  constructor(column, operator, value) {\n    super(column, operator, value);\n  }\n\n  toString() {\n    return \"not(\" + super.toString() + \")\";\n  }\n}\n\nclass InclusionOperator extends Condition {\n  constructor(inclusionType, column, operator, value) {\n    super(column, operator, value);\n    this.operator = inclusionType;\n  }\n\n  toString() {\n    return [\n      this.column,\n      this.operator,\n      \"(\",\n      Array.isArray(this.value)\n        ? this.value.map(val => quoteVal(val)).join(',')\n        : this.value,\n      \")\"\n    ].join('');\n  }\n}\n\nclass In extends InclusionOperator {\n  constructor(...args) {\n    super(\"in\", ...args);\n  }\n}\n\nclass NotIn extends InclusionOperator {\n  constructor(...args) {\n    super(\"not in\", ...args);\n  }\n}\n\nclass GlobalNotIn extends InclusionOperator {\n  constructor(...args) {\n    super(\"global not in\", ...args);\n  }\n}\n\nclass GlobalIn extends InclusionOperator {\n  constructor(...args) {\n    super(\"global in\", ...args);\n  }\n}\n\nconst Operators = {\n  Conjunction, Disjunction, Negation,\n  In, NotIn, GlobalIn, GlobalNotIn\n};\n\nfunction createCondition(...args) {\n  switch (args.length) {\n    case 1:\n      return args[0] instanceof Condition ? args[0] : new Condition(args[0]);\n    case 2:\n      return new Condition(args[0], EQUALS, args[1]);\n    case 3:\n      return new Condition(...args);\n    default:\n      throw new Error(\"Invalid condition args: \", args);\n  }\n}\n\nlet commonReplacer = [\n  /[\\0\\n\\r\\b\\t\\\\'\"\\x1a]/g, (s) => {\n    switch (s) {\n      case \"\\0\":\n        return \"\\\\0\";\n      case \"\\n\":\n        return \"\\\\n\";\n      case \"\\b\":\n        return \"\\\\b\";\n      case \"\\r\":\n        return \"\\\\r\";\n      case \"\\t\":\n        return \"\\\\t\";\n      case \"\\\\\":\n        return \"\\\\\\\\\";\n      case \"\\x1a\" :\n        return \"\\\\Z\";\n    }\n  }\n];\n\nclass Value extends SQLObject {\n  constructor(value) {\n    super();\n    this.value = value;\n  }\n\n  toString() {\n    if (typeof this.value === \"string\") {\n      return \"'\" + this.value.replace(...commonReplacer).replace(/'/g, \"''\") + \"'\";\n    }\n    if (typeof this.value === 'undefined') {\n      return \"''\";\n    }\n\n    if (Array.isArray(this.value)) {\n      return this.value.map(val => new Value(val)).join();\n    }\n\n    return this.value + '';\n  }\n}\n\nclass Term extends SQLObject {\n  constructor(term) {\n    super();\n    this.term = term;\n  }\n\n  toString() {\n    return '`' + this.term.replace(...commonReplacer).replace(/`/g, '\\\\`') + '`';\n  }\n}\n\nfunction quoteVal(value) {\n  return value instanceof SQLObject ? value : new Value(value);\n}\n\nfunction quoteTerm(term) {\n  return term instanceof SQLObject || Number.isFinite(term) ? term : new Term(term);\n}\n\n\nclass SQLFunction extends SQLObject {\n  constructor(name, ...args) {\n    super();\n    this.name = name;\n    this.args = args;\n  }\n\n  toString() {\n    return this.name +\n      \"(\" +\n      this.args.map((arg) => arg instanceof SQLObject || Number.isFinite(arg) ? arg : quoteTerm(arg)).join() +\n      \")\";\n  }\n}\n\nconst _curry_f = (name) => {\n  return (...args) => new SQLFunction(name, ...args)\n};\n\nconst _cast = (thing, t) => {\n  return new SQLFunction('cast', thing, quoteVal(t));\n};\n\nconst AggregateFunctions = {\n  count: _curry_f('count'),\n  any: _curry_f('any'),\n  anyLast: _curry_f('anyLast'),\n  min: _curry_f('min'),\n  max: _curry_f('max'),\n  sum: _curry_f('sum'),\n  avg: _curry_f('avg'),\n  uniq: _curry_f('uniq'),\n  uniqCombined: _curry_f('uniqCombined'),\n  uniqHLL12: _curry_f('uniqHLL12'),\n  uniqExact: _curry_f('uniqExact'),\n  groupArray: _curry_f('groupArray'),\n  groupUniqArray: _curry_f('groupUniqArray')\n};\n\nconst ArithmeticFunctions = {\n  plus: _curry_f('plus'),\n  minus: _curry_f('minus'),\n  multiply: _curry_f('multiply'),\n  divide: _curry_f('divide'),\n  intDiv: _curry_f('intDiv'),\n  intDivOrZero: _curry_f('intDivOrZero'),\n  modulo: _curry_f('modulo'),\n  negate: _curry_f('negate'),\n  abs: _curry_f('abs')\n};\n\nconst TimeFunctions = {\n  toYear: _curry_f('toYear'),\n  toMonth: _curry_f('toMonth'),\n  toDayOfMonth: _curry_f('toDayOfMonth'),\n  toDayOfWeek: _curry_f('toDayOfWeek'),\n  toHour: _curry_f('toHour'),\n  toMinute: _curry_f('toMinute'),\n  toTime: _curry_f('toTime'),\n  toDate: _curry_f('toDate'),\n  toDateTime: _curry_f('toDateTime'),\n  toDateTime64: _curry_f('toDateTime64'),\n  toStartOfDay: _curry_f('toStartOfDay'),\n  toStartOfMonth: _curry_f('toStartOfMonth'),\n  toStartOfQuarter: _curry_f('toStartOfQuarter'),\n  toStartOfYear: _curry_f('toStartOfYear'),\n  toStartOfMinute: _curry_f('toStartOfMinute'),\n  toStartOfFiveMinute: _curry_f('toStartOfFiveMinute'),\n  toStartOfHour: _curry_f('toStartOfHour'),\n\n  now: _curry_f('now'),\n  today: _curry_f('today'),\n  yesterday: _curry_f('yesterday')\n};\n\nconst IPAddrFunctions = {\n  toIPv4: _curry_f('toIPv4'),\n  toIPv6: _curry_f('toIPv6'),\n  IPv4NumToString: _curry_f('IPv4NumToString'),\n  IPv4StringToNum: _curry_f('IPv4StringToNum'),\n  IPv4NumToStringClassC: _curry_f('IPv4NumToStringClassC'),\n  IPv6NumToString: _curry_f('IPv6NumToString'),\n  IPv6StringToNum: _curry_f('IPv6StringToNum')\n};\n\nclass Raw extends SQLObject {\n  constructor(string) {\n    super();\n    this.raw = string;\n  }\n\n  toString() {\n    return this.raw;\n  }\n}\n\nclass Query extends SQLObject {\n}\n\nclass Select extends Query {\n  constructor() {\n    super();\n\n    this.tables = [];\n    this.conditions = new Conjunction();\n    this.having_conditions = new Conjunction();\n    this.preconditions = new Conjunction();\n    this.aggregations = [];\n    this.select_list = [];\n    this.order_expressions = [];\n    this.request_totals = undefined;\n    this.sampling = undefined;\n    this.limits = undefined;\n    this.limitbycolumns = undefined;\n  }\n\n  select(...columns) {\n    if (columns.length === 0) {\n      return this.select_list;\n    }\n\n    columns.forEach((col) => this.select_list.push(col));\n    return this;\n  }\n\n  /**\n   * @usage\n   *  q = selectBuilder->from('table0', ['table1', 'alias1'], { 'table2' : 'alias2'})->toString()\n   *  assertEquals(q, \"select * from table0, table1 as alias1, table2 as alias2\");\n   *\n   * @param tables\n   * @return {Select|Array}\n   */\n  from(...tables) {\n    if (!tables.length) {\n      return this.tables;\n    }\n\n    tables = tables.map(table => {\n      if (typeof table === \"string\") return [table, table];\n      if (Array.isArray(table)) return table;\n\n      return [Object.keys(table)[0], Object.values(table)[0]]\n    });\n\n    this.tables = tables;\n    return this;\n  }\n\n  prewhere(...args) {\n    this.preconditions.push(createCondition(...args));\n    return this;\n  }\n\n  orPrewhere(...args) {\n    let condition = createCondition(...args);\n    if (this.preconditions.length) {\n      this.preconditions = new Disjunction(this.preconditions, condition)\n    } else {\n      this.preconditions.push(condition)\n    }\n\n    return this;\n  }\n\n  where(...args) {\n    this.conditions.push(createCondition(...args));\n    return this;\n  }\n\n  orWhere(...args) {\n    let condition = createCondition(...args);\n    if (this.conditions.length) {\n      this.conditions = new Disjunction(this.conditions, condition)\n    } else {\n      this.conditions.push(condition);\n    }\n\n    return this;\n  }\n\n  groupBy(...aggregateExpressions) {\n    aggregateExpressions.forEach(a => this.aggregations.push(a));\n    return this;\n  }\n\n  withTotals(request_totals = true) {\n    this.request_totals = request_totals;\n    return this;\n  }\n\n  limit(number, offset) {\n    this.limits = {\n      number, offset\n    };\n    return this;\n  }\n\n  limitBy(limit, ...columns) {\n    this.limitbycolumns = {\n      limit, columns\n    };\n    return this;\n  }\n\n  orderBy(...expressions) {\n    expressions.forEach(e => this.order_expressions.push(e));\n    return this;\n  }\n\n  toString() {\n    let select_list;\n    if (this.select_list.length === 0) {\n      select_list = \"*\";\n    } else {\n      select_list = this.select_list.map(\n        c => Array.isArray(c)\n          ? quoteTerm(c[0]) + ' as ' + quoteTerm(c[1])\n          : quoteTerm(c)\n      ).join();\n    }\n\n\n    let from = this.from().map(\n      (table) =>\n        table[0] === table[1]\n          ? quoteTerm(table[0])\n          : quoteTerm(table[0]) + ' as ' + quoteTerm(table[1])\n    );\n    from = from.length ? \"from \" + from.join() : \"\";\n\n\n    let prewhere = this.preconditions.length ? \" prewhere \" + this.preconditions : \"\";\n    let where = this.conditions.length ? \" where \" + this.conditions : \"\";\n\n    let groupby = this.aggregations.length\n      ? \" group by \" + this.aggregations.map(c => quoteTerm(c)).join()\n      : \"\";\n\n    let having = this.having_conditions.length ? \" having \" + this.having_conditions : \"\";\n\n    let order_by = this.order_expressions.length\n      ? \"order by \" + this.order_expressions.map(e => Array.isArray(e) ? quoteTerm(e[0]) + \" \" + e[1] : quoteTerm(e)).join()\n      : \"\";\n\n\n    let with_totals = this.request_totals ? \" with totals \" : \"\";\n    let sample = this.sampling ? \" sample \" + this.sampling : \"\";\n\n    let limitby = this.limitbycolumns && this.limitbycolumns.columns.length\n      ? \" limit \" + this.limitbycolumns.limit + \" by \" + this.limitbycolumns.columns.map(c => quoteTerm(c)).join()\n      : '';\n\n    let limit = this.limits\n      ? \" limit \" + this.limits.number + (typeof this.limits.offset === \"undefined\" ? \"\" : \",\" + this.limits.offset)\n      : '';\n\n    return [\n      \"select \",\n      select_list,\n      from,\n      sample,\n      prewhere,\n      where,\n      groupby,\n      with_totals,\n      having,\n      order_by,\n      limitby,\n      limit\n    ].join(' ');\n\n  }\n}\n\n\nconst Queries = {\n  Select\n};\n\nconst Utility = {\n  quoteVal, val: quoteVal,\n  quoteTerm, term: quoteTerm,\n  raw: (s) => new Raw(s),\n  cast: _cast,\n};\n\n\nconst Dialect = {\n  ...Operators,\n  ...AggregateFunctions,\n  ...ArithmeticFunctions,\n  ...TimeFunctions,\n  ...IPAddrFunctions,\n  ...Consts,\n  ...Queries,\n  ...Utility\n};\nexport default Dialect;\n"],"file":"index.js"}